{
    "name" : "Mixpanel Events Trend",
    "description" : "Track your Mixpanel events by monitoring the 30 day trend, and compare the totals from yesterday with a week prior to yesterday. Originates from the Gallery.",
    

    "datasources" : {
        "mixpanel" : {
            "service" : "mixpanel",
            "libraryAlias" : "MixpanelEvents30Days",
            "name": "Mixpanel Events ({{ds.mixpanel.event1}},{{ds.mixpanel.event2}}) (30 days)",
            "description" : "Provide events for the last 30 days. Originates from the Gallery.",
            "type" : "simple_rest",
            "format" : "json",
            "refreshInterval" : 14400,
            "props" : {
                "endpoint_url": "http://mixpanel.com/api/2.0/events/?expire={hash.getExpiryTime(240)}&sig={hash.append(\"api_key={{auth.mixpanel.apiKey}}\").append(\"event=[\\\"{{ds.mixpanel.event1}}\\\",\\\"{{ds.mixpanel.event2}}\\\"]\").append(\"expire=\").append(hash.getExpiryTime(240)).append(\"interval=30\").append(\"type=general\").append(\"unit=day\").append(\"{{auth.mixpanel.apiSecret}}\").encodeMd5().toHex().printDigest()}&event=[\"{{ds.mixpanel.event1}}\",\"{{ds.mixpanel.event2}}\"]&interval=30&type=general&unit=day&api_key={{auth.mixpanel.apiKey}}"
            }
        }
    },

    "dsMappings" : {
        "mixpanel" : "ef6ac98651741d594e75KavyaMallur9"
    },

    "services" : [
        {
            "service" : "mixpanel"
        }
    ],
    "datasourceConfigModel" : [
        {
            "type" : "select",
            "id" : "ds.mixpanel.event1",
            "label" : "Event 1",
            "description":"Select two Mixpanel events you are interested in tracking."
        },
        {
            "type" : "select",
            "id" : "ds.mixpanel.event2",
            "label" : "Event 2"
        }
    ],
    "queries": [
        {
            "errorMessage":"Make sure you have the correct Mixpanel API Key and API Secret.",
            "connector": {
                "service": "mixpanel",
                "type": "simple_rest",
                "format": "json",
                "props": {
                    "endpoint_url": "http://mixpanel.com/api/2.0/events/names/?expire={hash.getExpiryTime(240)}&sig={hash.append(\"api_key={{auth.mixpanel.apiKey}}\").append(\"expire=\").append(hash.getExpiryTime(240)).append(\"{{auth.mixpanel.apiSecret}}\").encodeMd5().toHex().printDigest()}&api_key={{auth.mixpanel.apiKey}}"
                }
            },
            "results": [
                {
                    "propId" : "ds.mixpanel.event1", 
                    "propField" : "options", 
                    "labels": "/",  
                    "values": "/" 
                },
                {
                    "propId" : "ds.mixpanel.event2", 
                    "propField" : "options", 
                    "labels": "/",  
                    "values": "/" 
                }

            ]
        }
    ]
}