{
    "name": "Facebook Ads Campaign Impressions and Reach (Last 30 Days)",
    "description": "Compare your Facebook Ad Campaign impressions with reach over the past 30 days. Originates from the Gallery.",
    "sampleFormulas": {
        "ff7ebb89": {
            "txt": "\"<b>Creating Amazing Klips</b>\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": "<b>Creating Amazing Klips</b>"
                }]
            }
        },
        "696d74bd": {
            "txt": "array(\"126260\",\"204201\",\"254949\",\"195970\",\"91393\",\"93522\",\"102006\",\"102927\",\"119707\",\"96025\",\"78964\",\"74775\",\"59641\",\"68297\",\"128342\",\"107771\",\"90722\",\"52751\",\"33322\",\"31377\",\"36054\",\"35818\",\"109489\",\"188571\",\"203129\",\"140373\",\"125748\",\"139483\",\"82304\",\"31512\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": "126260"
                    }, {
                        "t": "l",
                        "v": "204201"
                    }, {
                        "t": "l",
                        "v": "254949"
                    }, {
                        "t": "l",
                        "v": "195970"
                    }, {
                        "t": "l",
                        "v": "91393"
                    }, {
                        "t": "l",
                        "v": "93522"
                    }, {
                        "t": "l",
                        "v": "102006"
                    }, {
                        "t": "l",
                        "v": "102927"
                    }, {
                        "t": "l",
                        "v": "119707"
                    }, {
                        "t": "l",
                        "v": "96025"
                    }, {
                        "t": "l",
                        "v": "78964"
                    }, {
                        "t": "l",
                        "v": "74775"
                    }, {
                        "t": "l",
                        "v": "59641"
                    }, {
                        "t": "l",
                        "v": "68297"
                    }, {
                        "t": "l",
                        "v": "128342"
                    }, {
                        "t": "l",
                        "v": "107771"
                    }, {
                        "t": "l",
                        "v": "90722"
                    }, {
                        "t": "l",
                        "v": "52751"
                    }, {
                        "t": "l",
                        "v": "33322"
                    }, {
                        "t": "l",
                        "v": "31377"
                    }, {
                        "t": "l",
                        "v": "36054"
                    }, {
                        "t": "l",
                        "v": "35818"
                    }, {
                        "t": "l",
                        "v": "109489"
                    }, {
                        "t": "l",
                        "v": "188571"
                    }, {
                        "t": "l",
                        "v": "203129"
                    }, {
                        "t": "l",
                        "v": "140373"
                    }, {
                        "t": "l",
                        "v": "125748"
                    }, {
                        "t": "l",
                        "v": "139483"
                    }, {
                        "t": "l",
                        "v": "82304"
                    }, {
                        "t": "l",
                        "v": "31512"
                    }]
                }]
            }
        },
        "67ab9519": {
            "txt": "array(\"57508\",\"69254\",\"105680\",\"69850\",\"38896\",\"40449\",\"46483\",\"42472\",\"55399\",\"40295\",\"29778\",\"33740\",\"33244\",\"36187\",\"48732\",\"46844\",\"41946\",\"33314\",\"25840\",\"25017\",\"28402\",\"28383\",\"64878\",\"80135\",\"98822\",\"96562\",\"87061\",\"91846\",\"62491\",\"25548\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": "57508"
                    }, {
                        "t": "l",
                        "v": "69254"
                    }, {
                        "t": "l",
                        "v": "105680"
                    }, {
                        "t": "l",
                        "v": "69850"
                    }, {
                        "t": "l",
                        "v": "38896"
                    }, {
                        "t": "l",
                        "v": "40449"
                    }, {
                        "t": "l",
                        "v": "46483"
                    }, {
                        "t": "l",
                        "v": "42472"
                    }, {
                        "t": "l",
                        "v": "55399"
                    }, {
                        "t": "l",
                        "v": "40295"
                    }, {
                        "t": "l",
                        "v": "29778"
                    }, {
                        "t": "l",
                        "v": "33740"
                    }, {
                        "t": "l",
                        "v": "33244"
                    }, {
                        "t": "l",
                        "v": "36187"
                    }, {
                        "t": "l",
                        "v": "48732"
                    }, {
                        "t": "l",
                        "v": "46844"
                    }, {
                        "t": "l",
                        "v": "41946"
                    }, {
                        "t": "l",
                        "v": "33314"
                    }, {
                        "t": "l",
                        "v": "25840"
                    }, {
                        "t": "l",
                        "v": "25017"
                    }, {
                        "t": "l",
                        "v": "28402"
                    }, {
                        "t": "l",
                        "v": "28383"
                    }, {
                        "t": "l",
                        "v": "64878"
                    }, {
                        "t": "l",
                        "v": "80135"
                    }, {
                        "t": "l",
                        "v": "98822"
                    }, {
                        "t": "l",
                        "v": "96562"
                    }, {
                        "t": "l",
                        "v": "87061"
                    }, {
                        "t": "l",
                        "v": "91846"
                    }, {
                        "t": "l",
                        "v": "62491"
                    }, {
                        "t": "l",
                        "v": "25548"
                    }]
                }]
            }
        },
        "5dccf3e7": {
            "txt": "array(\"2016-08-01\",\"2016-08-02\",\"2016-08-03\",\"2016-08-04\",\"2016-08-05\",\"2016-08-06\",\"2016-08-07\",\"2016-08-08\",\"2016-08-09\",\"2016-08-10\",\"2016-08-11\",\"2016-08-12\",\"2016-08-13\",\"2016-08-14\",\"2016-08-15\",\"2016-08-16\",\"2016-08-17\",\"2016-08-18\",\"2016-08-19\",\"2016-08-20\",\"2016-08-21\",\"2016-08-22\",\"2016-08-23\",\"2016-08-24\",\"2016-08-25\",\"2016-08-26\",\"2016-08-27\",\"2016-08-28\",\"2016-08-29\",\"2016-08-30\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": "2016-08-01"
                    }, {
                        "t": "l",
                        "v": "2016-08-02"
                    }, {
                        "t": "l",
                        "v": "2016-08-03"
                    }, {
                        "t": "l",
                        "v": "2016-08-04"
                    }, {
                        "t": "l",
                        "v": "2016-08-05"
                    }, {
                        "t": "l",
                        "v": "2016-08-06"
                    }, {
                        "t": "l",
                        "v": "2016-08-07"
                    }, {
                        "t": "l",
                        "v": "2016-08-08"
                    }, {
                        "t": "l",
                        "v": "2016-08-09"
                    }, {
                        "t": "l",
                        "v": "2016-08-10"
                    }, {
                        "t": "l",
                        "v": "2016-08-11"
                    }, {
                        "t": "l",
                        "v": "2016-08-12"
                    }, {
                        "t": "l",
                        "v": "2016-08-13"
                    }, {
                        "t": "l",
                        "v": "2016-08-14"
                    }, {
                        "t": "l",
                        "v": "2016-08-15"
                    }, {
                        "t": "l",
                        "v": "2016-08-16"
                    }, {
                        "t": "l",
                        "v": "2016-08-17"
                    }, {
                        "t": "l",
                        "v": "2016-08-18"
                    }, {
                        "t": "l",
                        "v": "2016-08-19"
                    }, {
                        "t": "l",
                        "v": "2016-08-20"
                    }, {
                        "t": "l",
                        "v": "2016-08-21"
                    }, {
                        "t": "l",
                        "v": "2016-08-22"
                    }, {
                        "t": "l",
                        "v": "2016-08-23"
                    }, {
                        "t": "l",
                        "v": "2016-08-24"
                    }, {
                        "t": "l",
                        "v": "2016-08-25"
                    }, {
                        "t": "l",
                        "v": "2016-08-26"
                    }, {
                        "t": "l",
                        "v": "2016-08-27"
                    }, {
                        "t": "l",
                        "v": "2016-08-28"
                    }, {
                        "t": "l",
                        "v": "2016-08-29"
                    }, {
                        "t": "l",
                        "v": "2016-08-30"
                    }]
                }]
            }
        }
    },
    "datasources": {
        "facebookAds-01": {
            "service": "facebook_ads",
            "libraryAlias": "FacebookAdsDailyStats",
            "name": "Facebook Ads Daily Stats (Last 30 Days)",
            "description": "Retrieve you daily Facebook Ads reach and impressions for the last 30 days. Originates from the Gallery.",
            "type": "facebook",
            "format": "json",
            "refreshInterval": 14400,
            "props": {
                "endpoint_url": "https://graph.facebook.com/v2.7/{{ds.facebook_ads.accountId}}/insights?date_preset=last_30_days&time_increment=1&time_increment=1&fields=reach,impressions,campaign_id,campaign_name&limit=100",
                "graphUrl": "https://graph.facebook.com/v2.7/{{ds.facebook_ads.accountId}}/insights?date_preset=last_30_days&time_increment=1&time_increment=1&fields=reach,impressions,campaign_id,campaign_name&limit=100",
                "qtype": "Graph API"
            }
        },
        "facebookAds-02": {
            "service": "facebook_ads",
            "libraryAlias": "FacebookAdsCampaigns",
            "name": "Facebook Ads Campaigns",
            "description": "Retrieve a list of your Facebook Ads Campaign. Originates from the Gallery.",
            "type": "facebook",
            "format": "json",
            "refreshInterval": 14400,
            "props": {
                "endpoint_url": "https://graph.facebook.com/v2.7/{{ds.facebook_ads.accountId}}/campaigns?fields=id,name,created_time,effective_status&limit=100",
                "graphUrl": "https://graph.facebook.com/v2.7/{{ds.facebook_ads.accountId}}/campaigns?fields=id,name,created_time,effective_status&limit=100",
                "qtype": "Graph API"
            }
        }
    },

    "dsMappings": {
        "facebookAds-01": "9c718fbc2987cc4da7d8doogeraspilk",
        "facebookAds-02": "fa2a9329eef7f49b4224doogeraspilk"
    },

    "services": [{
        "service": "facebook_ads"
    }],

    "datasourceConfigModel": [{
        "type": "select",
        "id": "ds.facebook_ads.accountId",
        "label": "Account",
        "description": "Select a Facebook Ads account, and then a corresponding campaign.",
        "isRequired": true,
        "onChangeQueries": ["q2"]
    }, {
        "type": "select",
        "id": "ds.facebook_ads.campaignId",
        "label": "Campaign",
        "isRequired": true,
        "onChangeQueries": ["q3"]
    }],
    "queries": [{
        "errorMessage": "Here are two suggestions:<br><br>1. Make sure the Facebook account you signed in with includes a Facebook Ads account. <br><br>2. From time to time, your Facebook OAuth token will expire. This token allows you to safely bring your data into Klipfolio. <a href='https://support.klipfolio.com/hc/en-us/articles/215548958-OAuth-token-expired-for-connected-accounts' target='_blank'>Find out how to re-authorize your OAuth tokens</a>.",
        "connector": {
            "service": "facebook_ads",
            "type": "facebook",
            "format": "json",
            "props": {
                "endpoint_url": "https://graph.facebook.com/v2.7/me/adaccounts?fields=id,name",
                "method": "GET",
                "qtype": "Graph API"
            }
        },
        "results": [{
            "propId": "ds.facebook_ads.accountId",
            "propField": "options",
            "labels": "/data/name",
            "values": "/data/id"
        }]
    }, {
        "id": "q2",
        "connector": {
            "service": "facebook_ads",
            "type": "facebook",
            "format": "json",
            "props": {
                "endpoint_url": "https://graph.facebook.com/v2.7/{{ds.facebook_ads.accountId}}/campaigns?fields=id,name,created_time,effective_status&filtering=[{'field':'effective_status','operator':'IN','value':['ACTIVE']}]",
                "method": "GET"
            }
        },
        "results": [{
            "propId": "ds.facebook_ads.campaignId",
            "propField": "options",
            "labels": "/data/name",
            "values": "/data/id"
        }]
    }]
}
