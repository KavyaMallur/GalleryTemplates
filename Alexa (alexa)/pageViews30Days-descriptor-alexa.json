{
    "name" : "Alexa Page Views per User (Last 30 days)",
    "description" : "Discover and compare your web page views (per user) against your key competitors. Originates from the Gallery.",
    

    "datasources" : {
        "alexa-01" : {
            "service" : "alexa",
            "name" : "Traffic History for {{ds.alexa.competitorUrl1}} (Last 31 days)",
            "libraryAlias": "TrafficHistory1",
            "description" : "Monitor traffic history for {{ds.alexa.competitorUrl1}}. Originates from the Gallery.",
            "type" : "simple_rest",
            "format" : "xml",
            "refreshInterval" : 14400,
            "props" : {
                "endpoint_url": "http://awis.amazonaws.com/?AWSAccessKeyId={{auth.alexa.apiKey}}&Action=TrafficHistory&ResponseGroup=History&SignatureMethod=HmacSHA1&SignatureVersion=2&Start={date.add(-31).tz('UTC').format('yyyyMMdd')}&Timestamp={date.addMinutes(10).tz('UTC').format(\"yyyy-MM-dd'T'HH'%3A'mm'%3A'ss'Z'\");}&Url={{ds.alexa.competitorUrl1}}&Signature={hash.append(\"GET\").appendNewLine().append(\"awis.amazonaws.com\").appendNewLine().append(\"/\").appendNewLine().append(\"AWSAccessKeyId={{auth.alexa.apiKey}}&Action=TrafficHistory&ResponseGroup=History&SignatureMethod=HmacSHA1&SignatureVersion=2&Start=\"+date.tz('UTC').add(-31).format('yyyyMMdd')+\"&Timestamp=\"+date.addMinutes(10).tz('UTC').format(\"yyyy-MM-dd'T'HH'%3A'mm'%3A'ss'Z'\")+\"&Url={{ds.alexa.competitorUrl1}}\").encodeHmacSha1(\"{{auth.alexa.apiSecret}}\").encodeBase64().encodeURL().printDigest();}"
            }
        },
        "alexa-02" : {
            "service" : "alexa",
            "name" : "Traffic History for {{ds.alexa.competitorUrl2}} (Last 31 days)",
            "libraryAlias": "TrafficHistory2",
            "description" : "Monitor traffic history for {{ds.alexa.competitorUrl2}}. Originates from the Gallery.",
            "type" : "simple_rest",
            "format" : "xml",
            "refreshInterval" : 14400,
            "props" : {
                "endpoint_url": "http://awis.amazonaws.com/?AWSAccessKeyId={{auth.alexa.apiKey}}&Action=TrafficHistory&ResponseGroup=History&SignatureMethod=HmacSHA1&SignatureVersion=2&Start={date.add(-31).tz('UTC').format('yyyyMMdd')}&Timestamp={date.addMinutes(10).tz('UTC').format(\"yyyy-MM-dd'T'HH'%3A'mm'%3A'ss'Z'\");}&Url={{ds.alexa.competitorUrl2}}&Signature={hash.append(\"GET\").appendNewLine().append(\"awis.amazonaws.com\").appendNewLine().append(\"/\").appendNewLine().append(\"AWSAccessKeyId={{auth.alexa.apiKey}}&Action=TrafficHistory&ResponseGroup=History&SignatureMethod=HmacSHA1&SignatureVersion=2&Start=\"+date.tz('UTC').add(-31).format('yyyyMMdd')+\"&Timestamp=\"+date.addMinutes(10).tz('UTC').format(\"yyyy-MM-dd'T'HH'%3A'mm'%3A'ss'Z'\")+\"&Url={{ds.alexa.competitorUrl2}}\").encodeHmacSha1(\"{{auth.alexa.apiSecret}}\").encodeBase64().encodeURL().printDigest();}"
            }
        },
        "alexa-03" : {
            "service" : "alexa",
            "name" : "Traffic History for {{ds.alexa.competitorUrl3}} (Last 31 days)",
            "libraryAlias": "TrafficHistory3",
            "description" : "Monitor traffic history for {{ds.alexa.competitorUrl3}}. Originates from the Gallery.",
            "type" : "simple_rest",
            "format" : "xml",
            "refreshInterval" : 14400,
            "props" : {
                "endpoint_url": "http://awis.amazonaws.com/?AWSAccessKeyId={{auth.alexa.apiKey}}&Action=TrafficHistory&ResponseGroup=History&SignatureMethod=HmacSHA1&SignatureVersion=2&Start={date.add(-31).tz('UTC').format('yyyyMMdd')}&Timestamp={date.addMinutes(10).tz('UTC').format(\"yyyy-MM-dd'T'HH'%3A'mm'%3A'ss'Z'\");}&Url={{ds.alexa.competitorUrl3}}&Signature={hash.append(\"GET\").appendNewLine().append(\"awis.amazonaws.com\").appendNewLine().append(\"/\").appendNewLine().append(\"AWSAccessKeyId={{auth.alexa.apiKey}}&Action=TrafficHistory&ResponseGroup=History&SignatureMethod=HmacSHA1&SignatureVersion=2&Start=\"+date.tz('UTC').add(-31).format('yyyyMMdd')+\"&Timestamp=\"+date.addMinutes(10).tz('UTC').format(\"yyyy-MM-dd'T'HH'%3A'mm'%3A'ss'Z'\")+\"&Url={{ds.alexa.competitorUrl3}}\").encodeHmacSha1(\"{{auth.alexa.apiSecret}}\").encodeBase64().encodeURL().printDigest();}"
            }
        }
    },

    "dsMappings" : {
        "alexa-01" : "8f8b64955a5d6d7949aenatceewzhere",
        "alexa-02" : "52921e6730d1e3223c4bnatceewzhere",
        "alexa-03" : "87f727f82dba81a9f8e2natceewzhere" 
    },

    "services" : [
        {
            "service" : "alexa"
        }
    ],

    "datasourceConfigModel" : [
        {
            "type" : "text",
            "id" : "ds.alexa.competitorUrl1",
            "label" : "Your URL",
            "description":"Enter your URL and two competitor URLs.",
            "isRequired" : "true",
            "urlEncode" : "true"  
        },
        {
            "type" : "text",
            "id" : "ds.alexa.competitorUrl2",
            "label" : "Competitor URL 1",
            "isRequired" : "true",
            "urlEncode" : "true"  
        },
        {
            "type" : "text",
            "id" : "ds.alexa.competitorUrl3",
            "label" : "Competitor URL 2",
            "isRequired" : "true",
            "urlEncode" : "true"  
        }
    ]
}

