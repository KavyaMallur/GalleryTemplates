{
    "name" : "HubSpot Blog Views (This Month)",
    "description" : "Compare how many people looked at your blog this month and last month, and use the handy indicator to quickly see if the percentage of views is up or down. Originates from the Gallery.",
    "sampleFormulas": {
        "2df66538-1": {
            "txt": "\"Amazing klips for January\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "1",
                        "v": "Amazing klips for January"
                    }]
                }]
            }
        },
        "6e191566-9": {
            "txt": "\"900\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "1",
                        "v": "900"
                    }]
                }]
            }
        },
        "f39d4a51-10": {
            "txt": "\"Views This Month\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "1",
                        "v": "Views This Month"
                    }]
                }]
            }
        },
        "8c8995d5-12": {
            "txt": "\"0.3353\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "1",
                        "v": "0.3353"
                    }]
                }]
            }
        },
        "b7c27d0c-13": {
            "txt": "\"674\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "1",
                        "v": "674"
                    }]
                }]
            }
        },
        "7838e4f1-2": {
            "txt": "array(\"852\",\"872\",\"876\",\"882\",\"882\",\"884\",\"889\",\"891\",\"894\",\"895\",\"899\",\"900\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": "852"
                    }, {
                        "t": "l",
                        "v": "872"
                    }, {
                        "t": "l",
                        "v": "876"
                    }, {
                        "t": "l",
                        "v": "882"
                    }, {
                        "t": "l",
                        "v": "882"
                    }, {
                        "t": "l",
                        "v": "884"
                    }, {
                        "t": "l",
                        "v": "889"
                    }, {
                        "t": "l",
                        "v": "891"
                    }, {
                        "t": "l",
                        "v": "894"
                    }, {
                        "t": "l",
                        "v": "895"
                    }, {
                        "t": "l",
                        "v": "899"
                    }, {
                        "t": "l",
                        "v": "900"
                    }]
                }]
            }
        },
        "b67401e3-5": {
            "txt": "array(\"552\",\"576\",\"582\",\"582\",\"584\",\"589\",\"591\",\"594\",\"595\",\"599\",\"601\",\"601\",\"602\",\"606\",\"609\",\"612\",\"616\",\"622\",\"636\",\"639\",\"644\",\"646\",\"649\",\"654\",\"654\",\"654\",\"655\",\"661\",\"666\",\"672\",\"674\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": "552"
                    }, {
                        "t": "l",
                        "v": "576"
                    }, {
                        "t": "l",
                        "v": "582"
                    }, {
                        "t": "l",
                        "v": "582"
                    }, {
                        "t": "l",
                        "v": "584"
                    }, {
                        "t": "l",
                        "v": "589"
                    }, {
                        "t": "l",
                        "v": "591"
                    }, {
                        "t": "l",
                        "v": "594"
                    }, {
                        "t": "l",
                        "v": "595"
                    }, {
                        "t": "l",
                        "v": "599"
                    }, {
                        "t": "l",
                        "v": "601"
                    }, {
                        "t": "l",
                        "v": "601"
                    }, {
                        "t": "l",
                        "v": "602"
                    }, {
                        "t": "l",
                        "v": "606"
                    }, {
                        "t": "l",
                        "v": "609"
                    }, {
                        "t": "l",
                        "v": "612"
                    }, {
                        "t": "l",
                        "v": "616"
                    }, {
                        "t": "l",
                        "v": "622"
                    }, {
                        "t": "l",
                        "v": "636"
                    }, {
                        "t": "l",
                        "v": "639"
                    }, {
                        "t": "l",
                        "v": "644"
                    }, {
                        "t": "l",
                        "v": "646"
                    }, {
                        "t": "l",
                        "v": "649"
                    }, {
                        "t": "l",
                        "v": "654"
                    }, {
                        "t": "l",
                        "v": "654"
                    }, {
                        "t": "l",
                        "v": "654"
                    }, {
                        "t": "l",
                        "v": "655"
                    }, {
                        "t": "l",
                        "v": "661"
                    }, {
                        "t": "l",
                        "v": "666"
                    }, {
                        "t": "l",
                        "v": "672"
                    }, {
                        "t": "l",
                        "v": "674"
                    }
                    ]
                }]
            }
        },
        "93f00710-3": {
            "txt": "array(\"Jan 1\",\"Jan 2\",\"Jan 3\",\"Jan 4\",\"Jan 5\",\"Jan 6\",\"Jan 7\",\"Jan 8\",\"Jan 9\",\"Jan 10\",\"Jan 11\",\"Jan 12\",\"Jan 13\",\"Jan 14\",\"Jan 15\",\"Jan 16\",\"Jan 17\",\"Jan 18\",\"Jan 19\",\"Jan 20\",\"Jan 21\",\"Jan 22\",\"Jan 23\",\"Jan 24\",\"Jan 25\",\"Jan 26\",\"Jan 27\",\"Jan 28\",\"Jan 29\",\"Jan 30\",\"Jan 31\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": "Jan 1"
                    }, {
                        "t": "l",
                        "v": "Jan 2"
                    }, {
                        "t": "l",
                        "v": "Jan 3"
                    }, {
                        "t": "l",
                        "v": "Jan 4"
                    }, {
                        "t": "l",
                        "v": "Jan 5"
                    }, {
                        "t": "l",
                        "v": "Jan 6"
                    }, {
                        "t": "l",
                        "v": "Jan 7"
                    }, {
                        "t": "l",
                        "v": "Jan 8"
                    }, {
                        "t": "l",
                        "v": "Jan 9"
                    }, {
                        "t": "l",
                        "v": "Jan 10"
                    }, {
                        "t": "l",
                        "v": "Jan 11"
                    }, {
                        "t": "l",
                        "v": "Jan 12"
                    }, {
                        "t": "l",
                        "v": "Jan 13"
                    }, {
                        "t": "l",
                        "v": "Jan 14"
                    }, {
                        "t": "l",
                        "v": "Jan 15"
                    }, {
                        "t": "l",
                        "v": "Jan 16"
                    }, {
                        "t": "l",
                        "v": "Jan 17"
                    }, {
                        "t": "l",
                        "v": "Jan 18"
                    }, {
                        "t": "l",
                        "v": "Jan 19"
                    }, {
                        "t": "l",
                        "v": "Jan 20"
                    }, {
                        "t": "l",
                        "v": "Jan 21"
                    }, {
                        "t": "l",
                        "v": "Jan 22"
                    }, {
                        "t": "l",
                        "v": "Jan 23"
                    }, {
                        "t": "l",
                        "v": "Jan 24"
                    }, {
                        "t": "l",
                        "v": "Jan 25"
                    }, {
                        "t": "l",
                        "v": "Jan 26"
                    }, {
                        "t": "l",
                        "v": "Jan 27"
                    }, {
                        "t": "l",
                        "v": "Jan 28"
                    }, {
                        "t": "l",
                        "v": "Jan 29"
                    }, {
                        "t": "l",
                        "v": "Jan 30"
                    }, {
                        "t": "l",
                        "v": "Jan 31"
                    }
                    ]
                }]
            }
        }
    },
    "datasources" : {
        "hubspot-01" : {
            "service" : "hubspot",
            "type" : "hubspot",
            "format" : "json",
            "name" :"Hubspot Blog Details",
            "libraryAlias" :"HubspotBlogDetails",
            "refreshInterval" : 14400,
            "description" :"Retrieve hubspot blog details for a selected blog. Originates from the Gallery.",
            "props":{
                "endpoint_url": "https://api.hubapi.com/content/api/v2/blogs/{{ds.hubspot.blogID}}",
                "method": "get",
                "portalId":"{{auth.hubspot.portalId}}",
                "oauth_sign_query_string": "oauth_sign_query_string"
            }
        },
        "hubspot-02" : {
            "service" : "hubspot",
            "type" : "hubspot",
            "format" : "json",
            "name" :"Hubspot Blog Views (Current Month)",
            "libraryAlias" :"HubspotBlogViews(CurrentMonth)",
            "refreshInterval" : 14400,
            "description" :"Retrieve blog views for the current month. Originates from the Gallery.",
            "props":{
                "endpoint_url": "https://api.hubapi.com/blogs/v3/blogs/{{ds.hubspot.blogID}}/views/d?startDate={date.startOfMonth.format('epochTime')}000&endDate={date.today.format('epochTime')}000",
                "method": "get",
                "portalId":"{{auth.hubspot.portalId}}",
                "oauth_sign_query_string": "oauth_sign_query_string"
            }
        },
        "hubspot-03" : {
            "service" : "hubspot",
            "type" : "hubspot",
            "format" : "json",
            "name" :"Hubspot Blog Views (Last Month)",
            "libraryAlias" :"HubspotBlogViews(LastMonth)",
            "refreshInterval" : 14400,
            "description" :"Retrieve blog views for the last month. Originates from the Gallery.",
            "props":{
                "endpoint_url": "https://api.hubapi.com/blogs/v3/blogs/{{ds.hubspot.blogID}}/views/d?startDate={date.addMonths(-1).startOfMonth.format('epochTime')}000&endDate={date.addMonths(-1).endOfMonth.format('epochTime')}000",
                "method": "get",
                "portalId":"{{auth.hubspot.portalId}}",
                "oauth_sign_query_string": "oauth_sign_query_string"
            }
        }
    },

    "dsMappings": {
        "hubspot-01" : "3f988b8a1d539a9ddda7KavyaMallur9",
        "hubspot-02" : "f82d17f2e4f0b7b048ceKavyaMallur9",
        "hubspot-03" : "3efbbf2701877e4c57edKavyaMallur9"
    },

    "services" : [
        {
            "service" : "hubspot"
        }
    ],
    "datasourceConfigModel": [{
        "type": "select",
        "id": "ds.hubspot.blogID",
        "label": "Blog",
        "description": "Select an Hubspot blog from the drop-down list.",
        "isRequired": true
    }],
    "queries": [{
        "errorMessage": "Here are two suggestions:<br><br>1. Make sure you have hubspot blogs configured in your account <br><br>2. From time to time, your Hubspot OAuth token will expire. This token allows you to safely bring your data into Klipfolio. <a href='http://klipfolio.uservoice.com/knowledgebase/articles/404228-oauth-token-expired' target='_blank'>Find out how to re-authorize your OAuth tokens</a>.",
        "connector": {
            "service" : "hubspot",
            "type" : "hubspot",
            "format" : "json",
            "props":{
                "endpoint_url": "https://api.hubapi.com/blogs/v3/blogs?limit=100",
                "method": "get",
                "portalId":"{{auth.hubspot.portalId}}",
                "oauth_sign_query_string": "oauth_sign_query_string"
            }
        },
        "results": [{
            "propId": "ds.hubspot.blogID",
            "propField": "options",
            "labels": "/objects/name",
            "values": "/objects/id"
        }]
    }]
}