{
    "name" : "Campaign Monitor List Stats",
    "description" : "Show the statistics of your Campaign Monitor List. Originates from the Gallery.",

    "datasources" : {
        "campaignMonitor-01" : {
            "service" : "campaign_monitor",
            "type": "simple_rest",
            "libraryAlias" : "CampaignMonitorLists",
            "name": "Campaign Monitor Lists",
            "description" : "Provide Your Campaign Monitor List",
            "format" : "json",
            "refreshInterval" : 14400,
            "props":{
                "auth_method" : "basic",
                "basic_auth_username" : "{{auth.campaign_monitor.apiKey}}",
                "basic_auth_password" : "x",
                "endpoint_url": "https://api.createsend.com/api/v3.1/clients/{{ds.campaign_monitor.clientId}}/lists.json",
                "method": "get"
            }
        },
        "campaignMonitor-02" : {
            "service" : "campaign_monitor",
            "type": "simple_rest",
            "libraryAlias" : "CampaignMonitorListStats",
            "name": "Campaign Monitor List Stats",
            "description" : "Provide the statistics of your Campaign Monitor list",
            "format" : "json",
            "refreshInterval" : 14400,
            "props":{
                "auth_method" : "basic",
                "basic_auth_username" : "{{auth.campaign_monitor.apiKey}}",
                "basic_auth_password" : "x",
                "endpoint_url": "https://api.createsend.com/api/v3.1/lists/{{ds.campaign_monitor.listId}}/stats.json",
                "method": "get"
            }
        }
    },

    "dsMappings" : {
        "campaignMonitor-01" : "80c5606234bdbe7f7df5doogeraspilk",
        "campaignMonitor-02" : "02bd58beb8e92b4ba90cdoogeraspilk"
    },

    "services" : [
        {
            "service" : "campaign_monitor"
        }
    ],
    "datasourceConfigModel" : [
        {
            "type" : "select",
            "id" : "ds.campaign_monitor.clientId",
            "label" : "Client Name",
            "description":"Select your Campaign Monitor Client Name.",
            "isRequired" : true,
            "onChangeQueries" : [ "q2" ]
        },
        {
            "type" : "select",
            "id" : "ds.campaign_monitor.listId",
            "label" : "List",
            "description":"Select your Campaign Monitor List Name.",
            "isRequired" : true
        }
    ],
    "queries": [
        {
            "errorMessage":"Make sure you have the correct Campaign Monitor API Key.",
            "connector": {
                "service": "campaign_monitor",
                "type": "simple_rest",
                "format": "json",
                "props": {
                "auth_method" : "basic",
                "basic_auth_username" : "{{auth.campaign_monitor.apiKey}}",
                "basic_auth_password" : "x",
                "endpoint_url": "https://api.createsend.com/api/v3.1/clients.json"
                }
            },
            "results": [
                {
                    "propId" : "ds.campaign_monitor.clientId",
                    "propField" : "options",
                    "labels": "/Name",
                    "values": "/ClientID"
                }
            ]
        },
        {
            "id": "q2",
            "connector": {
                "service": "campaign_monitor",
                "type": "simple_rest",
                "format": "json",
                "props": {
                "auth_method" : "basic",
                "basic_auth_username" : "{{auth.campaign_monitor.apiKey}}",
                "basic_auth_password" : "x",
                "endpoint_url": "https://api.createsend.com/api/v3.1/clients/{{ds.campaign_monitor.clientId}}/lists.json"
                }
            },
            "results": [
                {
                    "propId" : "ds.campaign_monitor.listId",
                    "propField" : "options",
                    "labels": "/Name",
                    "values": "/ListID"
                }
            ]
        }
    ]
}