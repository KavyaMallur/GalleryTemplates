{
	"name" : "GA: Website Performance (Last 30 Days)",
	"description" : "Track your website's Avg. Bounce Rate, Avg. Pageviews, New Sessions, and Avg. Time on Site for the last 30 days. Originates from the Gallery.",

	"datasources" : {
		"googleAnalytics-01" : {
			"service" : "google_analytics",
			"libraryAlias" : "GAKPIs",
			"name": "GA: KPIs (Last 30 Days)",
			"description" : "Track your website's KPI's including sessions, pageviews, bounce rate, and more, for the last 30 days. Originates from the Gallery.",
			"type" : "google_analytics",
			"format" : "csv",
			"refreshInterval" : 14400,
			"props" : {
				 "endpoint_url": "https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&metrics=ga:users,ga:newUsers,ga:percentNewSessions,ga:sessions,ga:bounces,ga:bounceRate,ga:avgSessionDuration,ga:goalStartsAll,ga:pageviews,ga:pageviewsPerSession&start-date={date.add(-30).format()}&end-date={date.today}&max-results=10000",
				 "max_pages": "1",
           		 "mode": "Simple",
           		 "profile": "{{ds.google_analytics.profileId}}",
           		  "timePeriod": "&start-date={date.add(-30).format()}&end-date={date.today}"
			}
		},
		"googleAnalytics-02" : {
			"service" : "google_analytics",
			"libraryAlias" : "GAKPIsPrevPeriod",
			"name": "GA: KPIs (Prev Period)",
			"description" : "Key Google Analytics KPIs for 30 days as of 30 days ago. Used for a comparison. Originates from the Gallery.",
			"type" : "google_analytics",
			"format" : "csv",
			"refreshInterval" : 14400,
			"props" : { 
				"advancedQuery": "https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&metrics=ga:users,ga:percentNewSessions,ga:sessions,ga:bounceRate,ga:avgSessionDuration,ga:goalStartsAll,ga:pageviewsPerSession,ga:pageviews,ga:newUsers,ga:bounces&start-date=60daysAgo&end-date=31daysAgo&max-results=10000",
            	"endpoint_url": "https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&metrics=ga:users,ga:percentNewSessions,ga:sessions,ga:bounceRate,ga:avgSessionDuration,ga:goalStartsAll,ga:pageviewsPerSession,ga:pageviews,ga:newUsers,ga:bounces&start-date=60daysAgo&end-date=31daysAgo&max-results=10000",
            	"max_pages": "1",
            	"mode": "Advanced",
            	"profile": "{{ds.google_analytics.profileId}}",
            	"timePeriod": "&start-date=60daysAgo&end-date=31daysAgo"
            }
		},
		"googleAnalytics-03" : {
			"service" : "google_analytics",
			"libraryAlias" : "KPIsbyDay",
			"name": "GA: KPI's by Day (Last 30 Days)",
			"description" : "Shows Users, New Users, Percent New Sessions, Sessions, Bounces, Bounce Rate, Avg. Session Duration, Goal Starts, Pageviews, and Pageviews per Session, by day for the last 30 days. Originates from the Gallery.",
			"type" : "google_analytics",
			"format" : "csv",
			"refreshInterval" : 14400,
			"props" : { 
            	"endpoint_url": "https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&dimensions=ga:date&metrics=ga:users,ga:newUsers,ga:percentNewSessions,ga:sessions,ga:bounces,ga:bounceRate,ga:avgSessionDuration,ga:goalStartsAll,ga:pageviews,ga:pageviewsPerSession&start-date={date.add(-30).format()}&end-date={date.today}&max-results=10000",
            	"max_pages": "10",
            	"mode": "Simple",
            	"profile": "{{ds.google_analytics.profileId}}",
            	"timePeriod": "&start-date={date.add(-30).format()}&end-date={date.today}"
            }
		}
	},

	"dsMappings" : {
		"googleAnalytics-01" :"4cd2b29b11d13657a71aniktawuzhere",
		"googleAnalytics-02" :"d7aa40d101d91c59473dniktawuzhere",
		"googleAnalytics-03" :"a017497b67d819dac62aniktawuzhere"
	},

	"services" : [
		{
			"service" : "google_analytics"
		}
	],

	"datasourceConfigModel" : [
		{
			"type" : "select",
			"id" : "ds.google_analytics.profileId",
			"label" : "Analytics Account",
			"description" : "Select an Analytics Account from the drop-down list.",
			"isRequired" : true
		}
	],
	"queries": [
        {
            "errorMessage":"Here are two suggestions:<br><br>1. Make sure you have access to your company's Google Analytics account. <br><br>2. From time to time, your Google OAuth token will expire. This token allows you to safely bring your data into Klipfolio. <a href='http://klipfolio.uservoice.com/knowledgebase/articles/404228-oauth-token-expired' target='_blank'>Find out how to re-authorize your OAuth tokens</a>.",
            "connector": {
                "service": "google_analytics",
                "type": "simple_rest",
                "format": "json",
                "props": {
                    "endpoint_url": "https://www.googleapis.com/analytics/v3/management/accounts/~all/webproperties/~all/profiles?fields=items(id%2Cname%2Cpermissions%2CwebPropertyId%2CwebsiteUrl)",
                    "method": "GET"
                }
            },
            "results": [
                { 
                    "propId" : "ds.google_analytics.profileId",
                    "propField" : "options", 
                    "labels": "/items/name",  
                    "values": "/items/id" 
                }
            ]
        }
    ]
}