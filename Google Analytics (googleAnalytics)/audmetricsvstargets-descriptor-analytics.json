{  
   "name":"Audience Metrics vs Targets",
   "description":"Track the number of users that visited your website, the number of sessions on your site, and the total number of pageviews for your site in the last 30 days. Originates from the Gallery.",
   "sampleFormulas": {
        "f304be9e": {
            "txt": "array(\"Users\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "Users"
                            }
                        ]
                    }
                ]
            }
        },
        "1c7a9308": {
            "txt": "array(\"Sessions\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "Sessions"
                            }
                        ]
                    }
                ]
            }
        },
        "2f1c50d6": {
            "txt": "array(\"Pageviews\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "Pageviews"
                            }
                        ]
                    }
                ]
            }
        },
        "3cd94cfb": {
            "txt": "array(\"168793\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "168793"
                            }
                        ]
                    }
                ]
            }
        },
        "c213e57d": {
            "txt": "array(\"0\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "0"
                            }
                        ]
                    }
                ]
            }
        },
        "67478b96": {
            "txt": "array(\"0\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "0"
                            }
                        ]
                    }
                ]
            }
        },
        "e102ccf6": {
            "txt": "array(\"128491.25\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "128491.25"
                            }
                        ]
                    }
                ]
            }
        },
        "8a0fafd9": {
            "txt": "array(\"129747\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "129747"
                            }
                        ]
                    }
                ]
            }
        },
        "0b0ac2c3": {
            "txt": "array(\"0\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "0"
                            }
                        ]
                    }
                ]
            }
        },
        "3a6586d2": {
            "txt": "array(\"0\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "0"
                            }
                        ]
                    }
                ]
            }
        },
        "18774296": {
            "txt": "array(\"284983.75\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "284983.75"
                            }
                        ]
                    }
                ]
            }
        },
        "9c274727": {
            "txt": "array(\"1535981\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "1535981"
                            }
                        ]
                    }
                ]
            }
        },
        "e8fb09dd": {
            "txt": "array(\"0\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "0"
                            }
                        ]
                    }
                ]
            }
        },
        "d54a3a86": {
            "txt": "array(\"0\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "0"
                            }
                        ]
                    }
                ]
            }
        },
        "6bc9efb6": {
            "txt": "array(\"669976.25\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [
                    {
                        "t": "f",
                        "v": "array",
                        "c": [
                            {
                                "t": "1",
                                "v": "669976.25"
                            }
                        ]
                    }
                ]
            }
        }

    },
   "datasources":{  
      "googleAnalytics-01":{  
         "service":"google_analytics",
         "libraryAlias":"GAKPIs",
         "name":"GA KPIs (Last 30 Days)",
         "description":"Track your website's KPI's including sessions, pageviews, bounce rate, and more, for the last 30 days. Originates from the Gallery.",
         "type":"google_analytics",
         "format":"csv",
         "refreshInterval":14400,
         "props":{  
            "endpoint_url":"https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&metrics=ga:users,ga:newUsers,ga:percentNewSessions,ga:sessions,ga:bounces,ga:bounceRate,ga:avgSessionDuration,ga:goalStartsAll,ga:pageviews,ga:pageviewsPerSession&start-date={date.add(-30).format()}&end-date={date.today}&max-results=10000",
            "max_pages":"1",
            "mode":"Simple",
            "profile":"{{ds.google_analytics.profileId}}",
            "timePeriod":"&start-date={date.add(-30).format()}&end-date={date.today}"
         }
      },
      "googleAnalytics-02":{  
         "service":"google_analytics",
         "libraryAlias":"GAKPIsPrevPeriod",
         "name":"GA KPIs (Prev 30 Days)",
         "description":"Key Google Analytics KPIs for 30 days as of 30 days ago. Used for a comparison. Originates from the Gallery.",
         "type":"google_analytics",
         "format":"csv",
         "refreshInterval":14400,
         "props":{  
            "advancedQuery":"https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&metrics=ga:users,ga:percentNewSessions,ga:sessions,ga:bounceRate,ga:avgSessionDuration,ga:goalStartsAll,ga:pageviewsPerSession,ga:pageviews,ga:newUsers,ga:bounces&start-date=60daysAgo&end-date=31daysAgo&max-results=10000",
            "endpoint_url":"https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&metrics=ga:users,ga:percentNewSessions,ga:sessions,ga:bounceRate,ga:avgSessionDuration,ga:goalStartsAll,ga:pageviewsPerSession,ga:pageviews,ga:newUsers,ga:bounces&start-date=60daysAgo&end-date=31daysAgo&max-results=10000",
            "max_pages":"1",
            "mode":"Advanced",
            "profile":"{{ds.google_analytics.profileId}}",
            "timePeriod":"&start-date=60daysAgo&end-date=31daysAgo"
         }
      }
   },
   "dsMappings":{  
      "googleAnalytics-01":"a77856261be17377a2d6niktawuzhere",
      "googleAnalytics-02":"5a177bea62178d42d895niktawuzhere"
   },
   "uiVariables":[  
      {  
         "name":"gaUserTarget",
         "value":""
      },
      {  
         "name":"gaSessionsTarget",
         "value":""
      },
      {  
         "name":"gaPageviewsTarget",
         "value":""
      }
   ],
   "services":[  
      {  
         "service":"google_analytics"
      }
   ],
   "datasourceConfigModel":[  
      {  
         "type":"select",
         "id":"ds.google_analytics.profileId",
          "label" : "Analytics Account",
          "description" : "Select an Analytics Account from the drop-down list.",
         "isRequired":true
      }
   ],
   "queries": [
        {
            "errorMessage":"Here are two suggestions:<br><br>1. Make sure you have access to your company's Google Analytics account. <br><br>2. From time to time, your Google OAuth token will expire. This token allows you to safely bring your data into Klipfolio. <a href='http://klipfolio.uservoice.com/knowledgebase/articles/404228-oauth-token-expired' target='_blank'>Find out how to re-authorize your OAuth tokens</a>.",
            "connector": {
                "service": "google_analytics",
                "type": "simple_rest",
                "format": "json",
                "props": {
                    "endpoint_url": "https://www.googleapis.com/analytics/v3/management/accounts/~all/webproperties/~all/profiles?fields=items(id%2Cname%2Cpermissions%2CwebPropertyId%2CwebsiteUrl)",
                    "method": "GET"
                }
            },
            "results": [
                { 
                    "propId" : "ds.google_analytics.profileId",
                    "propField" : "options", 
                    "labels": "/items/name",  
                    "values": "/items/id" 
                }
            ]
        }
    ]
}