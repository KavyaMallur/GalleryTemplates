{
  "name": "Google Analytics Goals",
  "description": "Which goals are converting and improving? Track the number of completions and the conversion percentage for each goal you have set up for your website.<br> Originates from the Gallery. (v1.0)",
  "sampleFormulas": {
    "98884217": {
      "txt": "\"-30\"",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "l",
            "v": "-30"
          }
        ]
      }
    },
    "c4ff0315": {
      "txt": "\"20160822\"",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "l",
            "v": "20160822"
          }
        ]
      }
    },
    "8acf0740": {
      "txt": "\"20160723\"",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "l",
            "v": "20160723"
          }
        ]
      }
    },
    "38d7df7f": {
      "txt": "\"20160920\"",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "l",
            "v": "20160920"
          }
        ]
      }
    },
    "a376abb1": {
      "txt": "\"20160821\"",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "l",
            "v": "20160821"
          }
        ]
      }
    },
    "e1afd368":{
      "txt": "\"Last 30 Days\"",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "l",
            "v": "Last 30 Days"
          }
        ]
      }
    },
    "f163ce9d": {
      "txt": "array(\"Contact Us\",\"Call In\",\"Proposal Step Two\",\"Proposal\")",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "f",
            "v": "array",
            "c": [
              {
                "t": "l",
                "v": "Contact Us"
              },
              {
                "t": "l",
                "v": "Call In"
              },
              {
                "t": "l",
                "v": "Proposal Step Two"
              },
              {
                "t": "l",
                "v": "Proposal"
              }
            ]
          }
        ]
      }
    },
    "c58b5e15-1": {
      "txt": "array(\"6\",\"7\",\"2\",\"1\")",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "f",
            "v": "array",
            "c": [
              {
                "t": "l",
                "v": "6"
              },
              {
                "t": "l",
                "v": "7"
              },
              {
                "t": "l",
                "v": "2"
              },
              {
                "t": "l",
                "v": "1"
              }
            ]
          }
        ]
      }
    },
    "68cc502d": {
      "txt": "array(\"6114\",\"2998\",\"3542\",\"5545\")",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "f",
            "v": "array",
            "c": [
              {
                "t": "l",
                "v": "6114"
              },
              {
                "t": "l",
                "v": "2998"
              },
              {
                "t": "l",
                "v": "3542"
              },
              {
                "t": "l",
                "v": "5545"
              }
            ]
          }
        ]
      }
    },
    "ce13b724": {
      "txt": "array(\".1189\",\".3784\",\".0648\",\".2254\")",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "f",
            "v": "array",
            "c": [
              {
                "t": "l",
                "v": ".1189"
              },
              {
                "t": "l",
                "v": ".3784"
              },
              {
                "t": "l",
                "v": ".0648"
              },
              {
                "t": "l",
                "v": ".2254"
              }
            ]
          }
        ]
      }
    },
    "2200591b": {
      "txt": "array(\"5125\",\"3285\",\"2590\",\"685\")",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "f",
            "v": "array",
            "c": [
              {
                "t": "l",
                "v": "5125"
              },
              {
                "t": "l",
                "v": "3285"
              },
              {
                "t": "l",
                "v": "2590"
              },
              {
                "t": "l",
                "v": "685"
              }
            ]
          }
        ]
      }
    },
    "368622ad": {
      "txt": "array(\"0.1929\",\"-0.0873\",\"0.3675\",\"7.0948\")",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "f",
            "v": "array",
            "c": [
              {
                "t": "l",
                "v": 0.1929
              },
              {
                "t": "l",
                "v": -0.0873
              },
              {
                "t": "l",
                "v": 0.3675
              },
              {
                "t": "l",
                "v": 7.0948
              }
            ]
          }
        ]
      }
    },
    "2fcb2b70": {
      "txt": "array(\"1727,2902,4289,3695,2052,5965,2749,3582,2292,5211,2137,5885,4821,2411,2180,4319,2586,4016,4002,2877,4147,5178,1933,2940,5589,4406,4518,5972,1230,1433\",\"2920,4182,2486,5548,1776,3323,1532,4298,5389,1098,3820,5747,3035,5480,3515,4616,2978,5442,3326,5444,4185,4163,1785,3523,3227,3114,5584,5460,4411,2018\",\"1557,3552,1899,3113,1703,4073,5055,2174,1333,5140,3029,3279,5202,4506,2672,2058,4509,5342,1443,5546,1999,4097,1300,1801,2238,2972,1777,1483,3121,5158\",\"3669,1242,2440,2984,4177,4597,3024,3814,4985,1789,5229,1220,4465,4101,4902,4715,4309,2009,2393,3180,3255,3052,4975,5490,1990,5635,2725,3601,1731,1106\")",
      "src": {
        "t": "expr",
        "v": false,
        "c": [
          {
            "t": "f",
            "v": "array",
            "c": [
              {
                "t": "l",
                "v": "1727,2902,4289,3695,2052,5965,2749,3582,2292,5211,2137,5885,4821,2411,2180,4319,2586,4016,4002,2877,4147,5178,1933,2940,5589,4406,4518,5972,1230,1433"
              },
              {
                "t": "l",
                "v": "2920,4182,2486,5548,1776,3323,1532,4298,5389,1098,3820,5747,3035,5480,3515,4616,2978,5442,3326,5444,4185,4163,1785,3523,3227,3114,5584,5460,4411,2018"
              },
              {
                "t": "l",
                "v": "1557,3552,1899,3113,1703,4073,5055,2174,1333,5140,3029,3279,5202,4506,2672,2058,4509,5342,1443,5546,1999,4097,1300,1801,2238,2972,1777,1483,3121,5158"
              },
              {
                "t": "l",
                "v": "3669,1242,2440,2984,4177,4597,3024,3814,4985,1789,5229,1220,4465,4101,4902,4715,4309,2009,2393,3180,3255,3052,4975,5490,1990,5635,2725,3601,1731,1106"
              }
            ]
          }
        ]
      }
    }
  },
  "datasources": {
    "googleAnalytics-01": {
      "service": "google_analytics",
      "name": "Google Analytics Goal Stats (Last 731 Days)",
      "libraryAlias": "GoogleAnalyticsGoalStatsLast731Days",
      "description": "Retrieve basic Google Analytics Goal Stats. Originates from the Gallery.",
      "type": "google_analytics",
      "format": "csv",
      "refreshInterval": 14400,
      "props": {
        "advancedQuery": "https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&dimensions=ga:date&metrics=ga:goal{props.gaGoal}Completions,ga:sessions&start-date=731daysAgo&end-date=today&max-results=10000",
        "endpoint_url": "https://www.googleapis.com/analytics/v3/data/ga?ids=ga:{{ds.google_analytics.profileId}}&dimensions=ga:date&metrics=ga:goal{props.gaGoal}Completions,ga:sessions&start-date=731daysAgo&end-date=today&max-results=10000",
        "max_pages": "1",
        "mode": "Advanced",
        "profile": "{{ds.google_analytics.profileId}}",
        "timePeriod": "&start-date={date.add(-730).format()}&end-date={date.yesterday}"
      }
    },
    "googleAnalytics-02": {
      "service": "google_analytics",
      "name": "Google Analytics All Goals",
      "libraryAlias": "GoogleAnalyticsAllGoals",
      "description": "Retrieve your Google Analytics goals. Originates from the Gallery.",
      "type": "simple_rest",
      "format": "json",
      "refreshInterval": 14400,
      "props": {
        "endpoint_url": "https://www.googleapis.com/analytics/v3/management/accounts/~all/webproperties/~all/profiles/~all/goals?fields=items(id%2Cname%2CprofileId%2Cactive)%2CtotalResults",
        "method": "get"
      }
    }
  },
  "dsMappings": {
    "googleAnalytics-01": "199f9ae3e8f758ede111natceewzhere",
    "googleAnalytics-02": "44bd307c1b04d4c6a72enatceewzhere"
  },
  "services": [
    {
      "service": "google_analytics"
    }
  ],
  "uiVariables": [
    {
      "name": "gaGoal",
      "value": "1"
    },
    {
      "name": "KTPeriod",
      "value": "-30"
    }
  ],
  "datasourceConfigModel": [
    {
      "type": "select",
      "id": "ds.google_analytics.profileId",
      "label": "Analytics Account",
      "description": "Select an Analytics Account from the drop-down list.",
      "isRequired": true
    }
  ],
  "queries": [
    {
      "errorMessage": "Here are two suggestions:<br><br>1. Make sure you have access to your company's Google Analytics account. <br><br>2. From time to time, your Google OAuth token will expire. This token allows you to safely bring your data into Klipfolio. <a href='https://support.klipfolio.com/hc/en-us/articles/215548958-OAuth-token-expired-for-connected-accounts' target='_blank'>Find out how to re-authorize your OAuth tokens</a>.",
      "connector": {
        "service": "google_analytics",
        "type": "simple_rest",
        "format": "json",
        "props": {
          "endpoint_url": "https://www.googleapis.com/analytics/v3/management/accounts/~all/webproperties/~all/profiles?fields=items(id%2Cname%2Cpermissions%2CwebPropertyId%2CwebsiteUrl)",
          "method": "GET"
        }
      },
      "results": [
        {
          "propId": "ds.google_analytics.profileId",
          "propField": "options",
          "labels": "/items/name",
          "values": "/items/id"
        }
      ]
    }
  ]
}