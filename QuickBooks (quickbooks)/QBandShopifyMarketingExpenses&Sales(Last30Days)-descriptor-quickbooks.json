{
    "name": "QuickBooks & Shopify: Marketing Expenses and Sales (Last 30 Days)",
    "description": "Mash up your Quickbooks and Shopify data to see your Marketing Expenses and Sales for the last 30 days. Originates from the Gallery.",
    "sampleFormulas": {
        "99792528": {
            "txt": "\"Advertising & Promotion\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": "Advertising & Promotion"
                }]
            }
        },
        "4daab177": {
            "txt": "\" https://static.klipfolio.com/static/klips/saas/templates/badges/quickbooks.png\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": " https://static.klipfolio.com/static/klips/saas/templates/badges/quickbooks.png"
                }]
            }
        },
        "a8bed880": {
            "txt": "\"23543.53\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": 23543.53
                }]
            }
        },
        "fa51227c": {
            "txt": "array(\"540\",\"270\",\"360\",\"1426.1399999999999\",\"720\",\"810\",\"180\",\"720\",\"450\",\"270\",\"360\",\"1432.81\",\"2225.2\",\"720\",\"810\",\"360\",\"1220.5900000000001\",\"1791.8\",\"270\",\"360\",\"450\",\"540\",\"630\",\"720\",\"810\",\"1760.5900000000001\",\"180\",\"2166.4\",\"450\",\"540\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": 540
                    }, {
                        "t": "l",
                        "v": 270
                    }, {
                        "t": "l",
                        "v": 360
                    }, {
                        "t": "l",
                        "v": 1426.1399999999999
                    }, {
                        "t": "l",
                        "v": 720
                    }, {
                        "t": "l",
                        "v": 810
                    }, {
                        "t": "l",
                        "v": 180
                    }, {
                        "t": "l",
                        "v": 720
                    }, {
                        "t": "l",
                        "v": 450
                    }, {
                        "t": "l",
                        "v": 270
                    }, {
                        "t": "l",
                        "v": 360
                    }, {
                        "t": "l",
                        "v": 1432.81
                    }, {
                        "t": "l",
                        "v": 2225.2
                    }, {
                        "t": "l",
                        "v": 720
                    }, {
                        "t": "l",
                        "v": 810
                    }, {
                        "t": "l",
                        "v": 360
                    }, {
                        "t": "l",
                        "v": 1220.5900000000001
                    }, {
                        "t": "l",
                        "v": 1791.8
                    }, {
                        "t": "l",
                        "v": 270
                    }, {
                        "t": "l",
                        "v": 360
                    }, {
                        "t": "l",
                        "v": 450
                    }, {
                        "t": "l",
                        "v": 540
                    }, {
                        "t": "l",
                        "v": 630
                    }, {
                        "t": "l",
                        "v": 720
                    }, {
                        "t": "l",
                        "v": 810
                    }, {
                        "t": "l",
                        "v": 1760.5900000000001
                    }, {
                        "t": "l",
                        "v": 180
                    }, {
                        "t": "l",
                        "v": 2166.4
                    }, {
                        "t": "l",
                        "v": 450
                    }, {
                        "t": "l",
                        "v": 540
                    }]
                }]
            }
        },
        "ff311585": {
            "txt": "\"648\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": 648
                }]
            }
        },
        "0ee8a343": {
            "txt": "\"0.1111111111111110771876298031202168203890323638916015625\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": "0.1111111111111110771876298031202168203890323638916015625"
                }]
            }
        },
        "acd1d2d5": {
            "txt": "\"21189.177\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": 21189.177
                }]
            }
        },
        "2b6391cf": {
            "txt": "\" https://static.klipfolio.com/static/klips/saas/templates/badges/shopify.png\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": " https://static.klipfolio.com/static/klips/saas/templates/badges/shopify.png"
                }]
            }
        },
        "165c662f": {
            "txt": "\"Amount Sold\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": "Amount Sold"
                }]
            }
        },
        "451f4408": {
            "txt": "\"258908\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": 258908
                }]
            }
        },
        "9a786885": {
            "txt": "array(\"3064\",\"7660\",\"6128\",\"9192\",\"10724\",\"13788\",\"3064\",\"12256\",\"7660\",\"4596\",\"6128\",\"10724\",\"9192\",\"7660\",\"10724\",\"7660\",\"4596\",\"6128\",\"4596\",\"9192\",\"10724\",\"13788\",\"10724\",\"7660\",\"10724\",\"10724\",\"7660\",\"10724\",\"12256\",\"9192\")",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "f",
                    "v": "array",
                    "c": [{
                        "t": "l",
                        "v": 3064
                    }, {
                        "t": "l",
                        "v": 7660
                    }, {
                        "t": "l",
                        "v": 6128
                    }, {
                        "t": "l",
                        "v": 9192
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 13788
                    }, {
                        "t": "l",
                        "v": 3064
                    }, {
                        "t": "l",
                        "v": 12256
                    }, {
                        "t": "l",
                        "v": 7660
                    }, {
                        "t": "l",
                        "v": 4596
                    }, {
                        "t": "l",
                        "v": 6128
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 9192
                    }, {
                        "t": "l",
                        "v": 7660
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 7660
                    }, {
                        "t": "l",
                        "v": 4596
                    }, {
                        "t": "l",
                        "v": 6128
                    }, {
                        "t": "l",
                        "v": 4596
                    }, {
                        "t": "l",
                        "v": 9192
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 13788
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 7660
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 7660
                    }, {
                        "t": "l",
                        "v": 10724
                    }, {
                        "t": "l",
                        "v": 12256
                    }, {
                        "t": "l",
                        "v": 9192
                    }]
                }]
            }
        },
        "c828400b": {
            "txt": "\"648\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": 648
                }]
            }
        },
        "83be907c": {
            "txt": "\"0.11420612813370477345298326099509722553193569183349609375\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": "0.11420612813370477345298326099509722553193569183349609375"
                }]
            }
        },
        "e0158b21": {
            "txt": "\"232369.93\"",
            "src": {
                "t": "expr",
                "v": false,
                "c": [{
                    "t": "l",
                    "v": 232369.93
                }]
            }
        }
    },
    "datasources": {
        "quickbooks-01": {
            "service": "quickbooks",
            "type": "quickbooks",
            "name": "Quickbooks Profit and Loss (Last 30 Days)",
            "libraryAlias": "QuickbooksProfitAndLoss(Last30Days)",
            "description": "  ",
            "format": "json",
            "refreshInterval": 14400,
            "props": {
                "endpoint_url": "https://quickbooks.api.intuit.com/v3/company/{{ds.quickbooks.companyID}}/reports/ProfitAndLoss?minorversion=5&start_date={date.add(-30).format('yyyy-MM-dd')}&end_date={date.add(-1).format('yyyy-MM-dd')}&summarize_column_by=Days"
            }
        },
        "quickbooks-02": {
            "service": "quickbooks",
            "type": "quickbooks",
            "name": "Quickbooks Profit and Loss (Prev 30 Days)",
            "libraryAlias": "QuickbooksProfitAndLoss(Prev30Days)",
            "description": "  ",
            "format": "json",
            "refreshInterval": 14400,
            "props": {
                "endpoint_url": "https://quickbooks.api.intuit.com/v3/company/{{ds.quickbooks.companyID}}/reports/ProfitAndLoss?minorversion=5&start_date={date.add(-60).format('yyyy-MM-dd')}&end_date={date.add(-31).format('yyyy-MM-dd')}&summarize_column_by=Days"
            }
        },
        "shopify-01": {
            "service": "shopify",
            "type": "shopify",
            "format": "json",
            "name": "Shopify Orders (Last 30 days)",
            "libraryAlias": "ShopifyOrdersLast30Days",
            "refreshInterval": 14400,
            "description": "Retrieves order information for the last 30 days. Originates from the Gallery.",
            "props": {
                "endpoint_url": "https://{{auth.shopify.shopName}}.myshopify.com/admin/orders.json?created_at_min={date.add(-30).format()}&created_at_max={date.add(1).format()}&fields=created_at,id,name,total-price_usd,referring_site,order_number,line_items,financial_status&status=any&financial_status=paid",
                "method": "get",
                "use_pagination": true,
                "max_pages": 10
            }
        },

        "shopify-02": {
            "service": "shopify",
            "type": "shopify",
            "format": "json",
            "name": "Shopify Orders (Prev 30 days)",
            "libraryAlias": "ShopifyOrdersPrev30Days",
            "refreshInterval": 14400,
            "description": "Retrieves order information for the previous 30 days. Originates from the Gallery.",
            "props": {
                "endpoint_url": "https://{{auth.shopify.shopName}}.myshopify.com/admin/orders.json?created_at_min={date.add(-60).format()}&created_at_max={date.add(-31).format()}&fields=created_at,id,name,total-price_usd,referring_site,order_number,line_items,financial_status&status=any&financial_status=paid",
                "method": "get",
                "use_pagination": true,
                "max_pages": 10
            }
        }
    },

    "dsMappings": {
        "quickbooks-01": "af02ff08d70da8afe008doogeraspilk",
        "quickbooks-02": "46657a0a25e76e967252doogeraspilk",
        "shopify-01": "6a8998837564aa4a0019KavyaMallur9",
        "shopify-02": "eee2d55f86ca1f158154KavyaMallur9"

    },

    "services": [{
        "service": "quickbooks"
    }, {
        "service": "shopify"
    }],

    "datasourceConfigModel": [{
        "type": "text",
        "id": "ds.quickbooks.companyID",
        "description": "Enter your QuickBooks Company ID. Need help? See <a href='https://support.klipfolio.com/hc/en-us/' target='_blank'>Klip Gallery: QuickBooks</a>.",
        "label": "Company ID",
        "ghostText": "12345678910",
        "isRequired": true,
        "debounceEnabled": true,
        "onChangeQueries": ["q1"]
    }, {
        "type": "select",
        "id": "ds.quickbooks.expenseName",
        "label": "Name of Expense",
        "description": "Please select the name of your marketing expense.",
        "isRequired": true
    }],
    "queries": [{
        "id": "q1",
        "errorMessage": "Every time you log into your account while adding a Klip, you are creating a new OAuth token.<br><br>1. Be sure to select the newest token for each service, because old tokens become invalid when new tokens are created.<br><br>2. From time to time, your OAuth tokens will expire. <a href='https://support.klipfolio.com/hc/en-us/articles/215548958-OAuth-token-expired-for-connected-accounts' target='_blank'>Find out how to re-authorize your OAuth tokens</a>.",
        "connector": {
            "service": "quickbooks",
            "type": "quickbooks",
            "format": "json",
            "props": {
                "endpoint_url": "https://quickbooks.api.intuit.com/v3/company/{{ds.quickbooks.companyID}}/reports/ProfitAndLoss?minorversion=5&start_date={date.add(-30).format('yyyy-MM-dd')}&end_date={date.add(-1).format('yyyy-MM-dd')}&summarize_column_by=Days"
            }
        },
        "results": [{
            "propId": "ds.quickbooks.expenseName",
            "propField": "options",
            "labels": "//Rows[preceding-sibling::Header//value='Expenses']/Row/ColData[1]/value | //Rows[preceding-sibling::Header//value='Expenses']//Summary/ColData[1]/value",
            "values": "//Rows[preceding-sibling::Header//value='Expenses']/Row/ColData[1]/value | //Rows[preceding-sibling::Header//value='Expenses']//Summary/ColData[1]/value"
        }]
    }]
}